{% load static %}
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="{% static 'core/css/index.css'%}">
    <title>Document</title>
</head>
<body>
    {% include 'core/header.html' %}
    {% block header %} {% endblock %}

<main>
    {% csrf_token %}
    <div class="container">
      <h1 class="mb-4 text-center">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞—â–µ–Ω–∏—è</h1>

      <!-- –ü–æ–ª–µ –ø–æ–∏—Å–∫–∞ –∏ —Ñ–∏–ª—å—Ç—Ä—ã -->
      <div class="row mb-4">
        <div class="col-md-8">
          <div class="input-group">
            <input type="text" class="form-control" placeholder="–ü–æ–∏—Å–∫ –ø–æ —Å–ª–æ–≤–∞–º" name="search" id="search" value="{{ search }}">
            <div class="input-group-append">
              <button class="btn btn-primary" id="search-go" type="button">–ò—Å–∫–∞—Ç—å</button>
            </div>
          </div>
        </div>
        <div class="col-md-4">

          <select class="form-control select-filter">
            <option name="filter" value="likes" {% if filter == 'likes' %}selected{% endif %}>–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –ª–∞–π–∫–∞–º</option>
            <option name="filter" value="time" {% if filter == 'time' %}selected{% endif %}>–§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏</option>
          </select>
        </div>
      </div>

        {% for complaint in complaints %}
            <div class="complaint" cid="{{ complaint.id }}">
              <div class="card mb-4">
                <div class="card-body">
                  <h5 class="card-title"> {% if complaint.is_anonymous %}
                    –ê–Ω–æ–Ω–∏–º–Ω–æ–µ –æ–±—Ä–∞—â–µ–Ω–∏–µ
                {% else %}
                    {{ complaint.user_name }}
                {% endif %}</h5>
                  <h6 class="card-subtitle mb-2 text-muted">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: {{ complaint.category }}</h6>
                  <p class="card-text">–¢–µ–∫—Å—Ç –æ–±—Ä–∞—â–µ–Ω–∏—è: {{ complaint.content }}</p>
                  <hr>
                  <p><strong>–û—Ç–≤–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:</strong> {% if complaint.response_text %}
                    {{ complaint.response_text }}
                {% else %}
                    –ù–µ—Ç –æ—Ç–≤–µ—Ç–∞
                {% endif %}</p>
                  <p class="text-muted">–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: {{ complaint.created_at}}</p>
                  <div style="display: flex">
                    <div style="display: flex; gap: 5px"><p>–õ–∞–π–∫–æ–≤:</p><span id="counter-{{ complaint.id }}">{{ complaint.like_count }}</span>
                    </div>
                    <button style="height: 30px;" id="{% if complaint.liked == True %}unlike{% else %}like{% endif %}" class="btn {% if complaint.liked == True %}like-press{% else %}like-no-press{% endif %} btn-sm ml-2">üëç</button>
                  </div>
            </div>
          </div>
            </div>
        {% endfor %}


    </div>
  </main>

{% include 'core/footer.html' %}
    {% block footer %} {% endblock %}
</body>
  <!-- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Bootstrap JS -->
  <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="{% static 'core/js/like-logic.js' %}"></script>
<script src="{% static 'core/js/search-logic.js' %}"></script>
</html>
